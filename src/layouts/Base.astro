---
interface Props {
  title: string;
  description?: string;
  canonicalUrl?: string;
  ogType?: string;
  ogImage?: string;
}

const {
  title,
  description = 'Committee Translation AI — Scholarly reference and translation service for Arabic and Persian sacred texts',
  canonicalUrl,
  ogType = 'website',
  ogImage,
} = Astro.props;
const currentPath = Astro.url.pathname;
const canonical = canonicalUrl || Astro.url.href;

import '../styles/theme.css';
import PostHog from '../components/PostHog.astro';
import UserMenu from '../components/UserMenu.svelte';
const googleClientId = import.meta.env.PUBLIC_GOOGLE_CLIENT_ID || '';
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <meta property="og:title" content={`${title} — CTAI`} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content={ogType} />
    <meta property="og:url" content={canonical} />
    <meta property="og:site_name" content="CTAI — Committee Translation AI" />
    {ogImage && <meta property="og:image" content={ogImage} />}
    <meta name="twitter:card" content={ogImage ? "summary_large_image" : "summary"} />
    <meta name="twitter:title" content={`${title} — CTAI`} />
    <meta name="twitter:description" content={description} />
    {ogImage && <meta name="twitter:image" content={ogImage} />}
    <meta name="theme-color" content="#1a1714" />
    <link rel="icon" href="/favicon.ico" sizes="32x32" />
    <link rel="icon" href="/favicon-512.png" type="image/png" sizes="512x512" />
    <link rel="icon" href="/favicon-192.png" type="image/png" sizes="192x192" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="canonical" href={canonical} />
    <slot name="head" />
    <link rel="preconnect" href="https://18441963.imgix.net" />
    <!-- Preload critical fonts — body, display, Arabic (normal + italic/bold) -->
    <link rel="preload" href="/fonts/source-serif-4-latin-normal.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="preload" href="/fonts/source-serif-4-latin-italic.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="preload" href="/fonts/eb-garamond-latin-normal.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="preload" href="/fonts/eb-garamond-latin-italic.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="preload" href="/fonts/scheherazade-new-arabic-normal-400.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="preload" href="/fonts/scheherazade-new-arabic-normal-700.woff2" as="font" type="font/woff2" crossorigin />
    <!-- Inline @font-face rules so browser knows fonts before first paint (bypasses Vite JS injection in dev) -->
    <style is:inline>
      @font-face { font-family:'Source Serif 4'; font-style:normal; font-weight:300 900; font-display:optional; src:url('/fonts/source-serif-4-latin-normal.woff2') format('woff2'); unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD; }
      @font-face { font-family:'Source Serif 4'; font-style:normal; font-weight:300 900; font-display:optional; src:url('/fonts/source-serif-4-latin-ext-normal.woff2') format('woff2'); unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF; }
      @font-face { font-family:'Source Serif 4'; font-style:italic; font-weight:300 900; font-display:optional; src:url('/fonts/source-serif-4-latin-italic.woff2') format('woff2'); unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD; }
      @font-face { font-family:'Source Serif 4'; font-style:italic; font-weight:300 900; font-display:optional; src:url('/fonts/source-serif-4-latin-ext-italic.woff2') format('woff2'); unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF; }
      @font-face { font-family:'EB Garamond'; font-style:normal; font-weight:400 700; font-display:optional; src:url('/fonts/eb-garamond-latin-normal.woff2') format('woff2'); unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD; }
      @font-face { font-family:'EB Garamond'; font-style:normal; font-weight:400 700; font-display:optional; src:url('/fonts/eb-garamond-latin-ext-normal.woff2') format('woff2'); unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF; }
      @font-face { font-family:'EB Garamond'; font-style:italic; font-weight:400 700; font-display:optional; src:url('/fonts/eb-garamond-latin-italic.woff2') format('woff2'); unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD; }
      @font-face { font-family:'EB Garamond'; font-style:italic; font-weight:400 700; font-display:optional; src:url('/fonts/eb-garamond-latin-ext-italic.woff2') format('woff2'); unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF; }
      @font-face { font-family:'Scheherazade New'; font-style:normal; font-weight:400; font-display:optional; src:url('/fonts/scheherazade-new-arabic-normal-400.woff2') format('woff2'); unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC; }
      @font-face { font-family:'Scheherazade New'; font-style:normal; font-weight:400; font-display:optional; src:url('/fonts/scheherazade-new-latin-normal-400.woff2') format('woff2'); unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD; }
      @font-face { font-family:'Scheherazade New'; font-style:normal; font-weight:700; font-display:optional; src:url('/fonts/scheherazade-new-arabic-normal-700.woff2') format('woff2'); unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC; }
      @font-face { font-family:'Scheherazade New'; font-style:normal; font-weight:700; font-display:optional; src:url('/fonts/scheherazade-new-latin-normal-700.woff2') format('woff2'); unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD; }
      @font-face { font-family:'JetBrains Mono'; font-style:normal; font-weight:400; font-display:optional; src:url('/fonts/jetbrains-mono-latin-normal.woff2') format('woff2'); unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD; }
      @font-face { font-family:'JetBrains Mono'; font-style:normal; font-weight:400; font-display:optional; src:url('/fonts/jetbrains-mono-latin-ext-normal.woff2') format('woff2'); unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF; }
      @font-face { font-family:'JetBrains Mono'; font-style:normal; font-weight:500; font-display:optional; src:url('/fonts/jetbrains-mono-latin-normal.woff2') format('woff2'); unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD; }
      @font-face { font-family:'JetBrains Mono'; font-style:normal; font-weight:500; font-display:optional; src:url('/fonts/jetbrains-mono-latin-ext-normal.woff2') format('woff2'); unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF; }
    </style>
    <title>{title} — CTAI</title>
    <script>if ('serviceWorker' in navigator) navigator.serviceWorker.register('/sw.js');</script>
    <PostHog />
  </head>
  <body class="min-h-screen text-ink-300 font-serif antialiased">
    <a href="#main" class="sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-2 focus:z-[100] focus:bg-gold-400 focus:text-ink-900 focus:px-4 focus:py-2 focus:rounded focus:text-sm font-bold">
      Skip to main content
    </a>

    <header class="border-b border-ink-800/60 backdrop-blur-sm sticky top-0 z-50 bg-ink-900/80">
      <nav aria-label="Main navigation" class="mx-auto max-w-6xl px-6 py-4 flex items-center justify-between">
        <a href="/" class="group flex items-center gap-3">
          <span class="text-gold-400 font-mono text-xs tracking-widest uppercase opacity-80 group-hover:opacity-100 transition-opacity">CTAI</span>
          <span class="hidden md:block w-px h-4 bg-ink-700"></span>
          <span class="hidden md:block text-xs text-ink-500 font-mono">Committee Translation AI</span>
        </a>
        <div class="flex items-center gap-1">
          {[
            { href: '/models/', label: 'Models' },
            { href: '/concordance/', label: 'Concordance' },
            { href: '/translations/', label: 'Translations' },
            { href: '/try', label: 'Try it' },
            { href: '/articles/', label: 'Blog' },
          ].map(link => link.disabled ? (
            <span
              class="px-3 py-1.5 text-xs font-mono tracking-wide rounded-md text-ink-600 cursor-default"
              title="Coming soon"
            >
              {link.label}
            </span>
          ) : (
            <a
              href={link.href}
              class:list={[
                'px-3 py-1.5 text-xs font-mono tracking-wide rounded-md transition-all',
                currentPath.startsWith(link.href)
                  ? 'bg-ink-800 text-gold-400'
                  : 'text-ink-400 hover:text-ink-200 hover:bg-ink-800/50',
              ]}
            >
              {link.label}
            </a>
          ))}
          <UserMenu client:only="svelte" clientId={googleClientId} />
        </div>
      </nav>
    </header>

    <main id="main" class="mx-auto max-w-6xl px-6 py-10">
      <slot />
    </main>

    <footer class="border-t border-ink-700/60 mt-20 bg-ink-800/40">
      <div class="mx-auto max-w-6xl px-6 py-6">
        <div class="flex items-center gap-3 mb-4">
          <span class="text-gold-400/60 font-mono text-[10px] tracking-[0.3em] uppercase">CTAI</span>
          <span class="w-px h-3 bg-ink-700"></span>
          <span class="text-ink-500 text-[10px]">Committee Translation AI</span>
          <span class="flex-1 h-px bg-ink-700/40"></span>
          <span class="text-[10px] text-ink-600">Built by <a href="/contact" class="text-ink-500 hover:text-gold-400 transition-colors">Chad Jones</a> — while procrastinating real work</span>
        </div>
        <div class="flex flex-col sm:flex-row gap-4 sm:gap-8">
          <div class="flex-1">
            <a href="/my-projects" class="text-[10px] text-ink-600 hover:text-ink-500 font-mono tracking-wide uppercase mb-1.5 block transition-colors">My Projects</a>
            <div class="flex flex-wrap gap-x-1">
              {[
                { href: 'https://oceanlibrary.com', name: 'OceanLibrary', desc: 'interfaith library' },
                { href: 'https://siftersearch.com', name: 'SifterSearch', desc: 'AI librarian search' },
                { href: 'https://bahai-education.org', name: 'Bahai-Education', desc: "Baha\u2019i blog" },
                { href: 'https://oceanoflights.org', name: 'OceanofLights', desc: 'Universe of Tablets' },
                { href: 'https://drbi.org', name: 'DRBI', desc: "Baha\u2019i Institute" },
                { href: 'https://novelarabic.com', name: 'NovelArabic', desc: 'Arabic story labs' },
                { href: 'https://almost-english.com', name: 'Almost-English', desc: 'cognate bridges' },
                { href: 'https://xswarm.ai', name: 'xSwarm', desc: 'agentic dev tools' },
                { href: 'https://thinkdone.com', name: 'ThinkDone', desc: 'AI productivity' },
              ].map((link, i, arr) => (
                <span class="text-[11px] leading-snug">
                  <a href={link.href} class="text-ink-400 hover:text-gold-400 transition-colors" title={link.desc}>{link.name}</a>{i < arr.length - 1 && <span class="text-ink-700"> · </span>}
                </span>
              ))}
            </div>
          </div>
          <div class="flex-1">
            <a href="/cool-projects" class="text-[10px] text-ink-600 hover:text-ink-500 font-mono tracking-wide uppercase mb-1.5 block transition-colors">Other Cool Projects</a>
            <div class="flex flex-wrap gap-x-1">
              {[
                { href: 'https://bahai-library.org', name: 'Bahai-Library', desc: "Bah\u00e1\u2019\u00ed documents" },
                { href: 'https://theutteranceproject.com', name: 'UtteranceProject', desc: 'readings resource' },
                { href: 'https://upliftingwords.org', name: 'UpliftingWords', desc: "Bah\u00e1\u2019\u00ed collection" },
                { href: 'https://afnanlibrary.org', name: 'AfnanLibrary', desc: 'manuscripts' },
                { href: 'https://blog.loomofreality.org', name: 'LoomofReality', desc: 'tablet inventory' },
                { href: 'https://www.bahaiblog.net', name: 'BahaiBlog', desc: 'arts & musings' },
                { href: 'https://bahaiteachings.org', name: 'BahaiTeachings', desc: 'opinion essays' },
              ].map((link, i, arr) => (
                <span class="text-[11px] leading-snug">
                  <a href={link.href} class="text-ink-400 hover:text-gold-400 transition-colors" title={link.desc}>{link.name}</a>{i < arr.length - 1 && <span class="text-ink-700"> · </span>}
                </span>
              ))}
            </div>
          </div>
        </div>
        <div class="mt-4 pt-3 border-t border-ink-800/40 text-center">
          <a href="/terms" class="text-[9px] text-ink-600 hover:text-ink-500 transition-colors">Terms</a>
          <span class="text-ink-700 text-[9px] mx-1.5">&middot;</span>
          <a href="/privacy" class="text-[9px] text-ink-600 hover:text-ink-500 transition-colors">Privacy</a>
          <span class="text-ink-700 text-[9px] mx-1.5">&middot;</span>
          <a href="/contact" class="text-[9px] text-ink-600 hover:text-ink-500 transition-colors">Contact</a>
        </div>
      </div>
    </footer>
  </body>
</html>
